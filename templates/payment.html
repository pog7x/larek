{% extends "base.html" %}
{% load static %}
{% load stringfilters %}

{% block title %}Оплата{% endblock %}

{% block content %}
<div class="container">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{% url 'index' %}">Главная</a></li>
            <li class="breadcrumb-item"><a href="{% url 'orders_history' %}">Заказы</a></li>
            <li class="breadcrumb-item active" aria-current="page">Оплата</li>
        </ol>
    </nav>

    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-primary text-white text-center py-4">
                    <i class="bi bi-credit-card display-4"></i>
                    <h2 class="h4 mt-3 mb-0">Оплата заказа</h2>
                </div>
                <div class="card-body p-4">
                    <div class="text-center mb-4">
                        <span class="display-5 fw-bold text-primary">${{ object.sum|commaprice }}</span>
                    </div>

                    <form method="post" action="">
                        {% csrf_token %}
                        
                        <div class="mb-4">
                            <label for="card_number" class="form-label">Номер карты</label>
                            <div class="input-group input-group-lg">
                                <span class="input-group-text">
                                    <i class="bi bi-credit-card"></i>
                                </span>
                                <input 
                                    type="text" 
                                    class="form-control" 
                                    id="card_number" 
                                    name="card_number" 
                                    placeholder="0000 0000"
                                    data-mask="card"
                                    required
                                    autocomplete="off"
                                >
                            </div>
                            <div class="form-text">Введите 8 цифр номера карты</div>
                        </div>

                        <button type="submit" class="btn btn-primary btn-lg w-100">
                            <i class="bi bi-lock me-2"></i>Оплатить ${{ object.sum|commaprice }}
                        </button>
                    </form>

                    <div class="text-center mt-4">
                        <small class="text-muted">
                            <i class="bi bi-shield-check me-1"></i>
                            Безопасная оплата
                        </small>
                    </div>
                </div>
            </div>

            <!-- Payment Methods -->
            <div class="text-center mt-4">
                <img src="{% static 'assets/img/payments/visa.png' %}" alt="Visa" height="24" class="mx-1">
                <img src="{% static 'assets/img/payments/mastercard.png' %}" alt="Mastercard" height="24" class="mx-1">
                <img src="{% static 'assets/img/payments/paypal.png' %}" alt="PayPal" height="24" class="mx-1">
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const cardInput = document.getElementById('card_number');
    if (cardInput && typeof IMask !== 'undefined') {
        IMask(cardInput, {
            mask: '0000 0000'
        });
    }
});
</script>
{% endblock %}
